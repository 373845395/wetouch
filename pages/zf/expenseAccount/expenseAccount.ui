<!--note.ui-->
<template>
  <ui-page>
    <ui-nav-bar slot="nav-bar" class="nav_bar">
      <ui-row height="46">
        <ui-col vertical-align="middle" align="left" space-left="10"  width="50" bindtap="navigateBack">
          <ui-view>
            <ui-icon name="arrow-left" size="16" color="#fff"></ui-icon>返回
          </ui-view>
        </ui-col>
        <ui-col vertical-align="middle" align="center">
          <ui-text class="nav_title">报销申请</ui-text>
        </ui-col>
        <ui-col vertical-align="middle" align="center" width="50">
          <!-- <ui-icon name="bianji" size="20" color="#fff"></ui-icon> -->
        </ui-col>
      </ui-row>
    </ui-nav-bar>

    <ui-view class="form_content">
      <ui-row height="50">
        <ui-col vertical-align="middle" align="left" width="70" space-left="10">
          <ui-view>报销人</ui-view>
        </ui-col>
        <ui-col vertical-align="middle" align="right" space="20">
          <ui-view class="right_column">{{ userName }}</ui-view>
        </ui-col>
      </ui-row>
      <ui-row height="50">
        <ui-col vertical-align="middle" align="left" width="70" space-left="10">
          <ui-view>报销日期</ui-view>
        </ui-col>
        <ui-col vertical-align="middle" align="right" space="20" bindtap="radioCalendaropen">
          <ui-view class="right_column">{{ radioYear }}年{{radioMonth}}月{{radioDay}}日</ui-view>
        </ui-col>
      </ui-row>
      <ui-row height="50">
        <ui-col vertical-align="middle" align="left" width="70" space-left="10">
          <ui-view>项目</ui-view>
        </ui-col>
        <ui-col vertical-align="middle" align="right" space="20">
          <ui-view class="right_column">
            <ui-picker title="" range="{{ projectList }}" value="{{ projectValue }}" bindchange="handleChange">
          </ui-view>
        </ui-col>
      </ui-row>
      <ui-row height="50">
        <ui-col vertical-align="middle" align="left" width="70" space-left="10">
          <ui-view>出差地点</ui-view>
        </ui-col>
        <ui-col vertical-align="middle" align="right" space="20">
          <ui-view class="right_column">
            <ui-picker mode="multiSelector" is-chain value="{{ siteIndex }}" range="{{ siteList }}" range-key="name" bindchange="siteChange"></ui-picker>
          </ui-view>
        </ui-col>
      </ui-row>

      <ui-row height="50">
        <ui-col vertical-align="middle" align="left" width="70" space-left="10">
          <ui-view>出差时间</ui-view>
        </ui-col>
        <ui-col vertical-align="middle" align="right" space="20" bindtap="rangeCalendaropen">
          <ui-row height="50">
            <ui-col vertical-align="middle" align="center">
              <ui-view class="right_column">{{ startTime2 }}</ui-view>
            </ui-col>
            <ui-col vertical-align="middle" align="center" width="30">
              <ui-view class="right_column">至</ui-view>
            </ui-col>
            <ui-col vertical-align="middle" align="center">
              <ui-view class="right_column">{{ endTime2 }}</ui-view>
            </ui-col>
          </ui-row>
        </ui-col>
      </ui-row>
      <ui-row height="50">
        <ui-col vertical-align="middle" align="left" width="70" space-left="10">
          <ui-view>出差天数</ui-view>
        </ui-col>
        <ui-col vertical-align="middle" align="right" space="20">
          <ui-view class="right_column">{{ day }} 天</ui-view>
        </ui-col>
      </ui-row>
      <ui-row height="50">
        <ui-col vertical-align="middle" align="left" width="70" space-left="10">
          <ui-view>出差补助</ui-view>
        </ui-col>
        <ui-col vertical-align="middle" align="right" space="20">
          <ui-view class="right_column">{{ subsidy }} {{ typeType }}</ui-view>
        </ui-col>
      </ui-row>
      <ui-row height="50">
        <ui-col vertical-align="middle" align="left" width="70" space-left="10">
          <ui-view>差补总金额（元）</ui-view>
        </ui-col>
        <ui-col vertical-align="middle" align="right" space="20">
          <ui-view class="right_column">{{ subsidy*day*rate }}</ui-view>
        </ui-col>
      </ui-row>

      <!-- 报销明细 -->
      <ui-view class="expense_wrap">
        <ui-view class="expense_list" ui:for="{{ expendform }}" ui:for-item="item" ui:for-index="index1">
          <ui-view class="expense_title">
            <ui-view>
              报销单（{{ index1+1 }}）
            </ui-view>
          </ui-view>
          <ui-row height="50">
            <ui-col vertical-align="middle" align="left" width="70" space-left="10">
              <ui-view>币种</ui-view>
            </ui-col>
            <ui-col vertical-align="middle" align="right" space="20" bindtap="showIndexList(index1)">
              <ui-view class="right_column">
                <!-- <ui-picker title="" range="{{ currencyList }}" value="{{ currencyValue }}"> -->
                  {{ item.currency }}
              </ui-view>
            </ui-col>
          </ui-row>
          <ui-view class="detail_content">
            <ui-view ui:for="{{ item.expendlist }}" ui:for-item="item2" ui:for-index="index2">
              <ui-row class="title" height="30" space-top="0">
                <ui-col></ui-col>
                <ui-col vertical-align="bottom" align="right" width="100" space-right="10" bindtap="detailDelete(index1,index2)">
                  <ui-text class="delete">删除</ui-text>
                </ui-col>
              </ui-row>
              <ui-row class="title" height="30">
                <ui-col vertical-align="middle" align="center">
                  <ui-divider>报销明细({{ index2+1 }})</ui-divider>
                </ui-col>
              </ui-row>
              <ui-row height="50">
                <ui-col vertical-align="middle" align="left" width="75" space-left="10">
                  <ui-view>类别/明细</ui-view>
                </ui-col>
                <ui-col vertical-align="middle" space="20">
                  <ui-view class="right_column" bindtap="forIndex(index1,index2)">
                    <ui-picker mode="multiSelector" is-chain value="{{ [ item2.subject1,item2.subject2 ] }}" range="{{ sortList }}" range-key="name" bindchange="sortChange"></ui-picker>
                  </ui-view>
                </ui-col>
              </ui-row>

              <ui-row height="50">
                <ui-col vertical-align="middle" align="left" width="70" space-left="10">
                  <ui-view>备注</ui-view>
                </ui-col>
                <ui-col vertical-align="middle" space="20">
                  <ui-input placeholder="备注" placeholder-style="color:#999B9E" ui:model="{{ item2.subject3 }}" show-clear="false"></ui-input>
                </ui-col>
              </ui-row>



              <ui-row height="50">
                <ui-col vertical-align="middle" align="left" width="70" space-left="10">
                  <ui-view>报销金额</ui-view>
                </ui-col>
                <ui-col vertical-align="middle" space="20">
                  <ui-input placeholder="请输入数字" placeholder-style="color:#999B9E" type="number" ui:model="{{ item2.money }}" show-clear="false"></ui-input>
                </ui-col>
              </ui-row>

              <!-- 附件 -->
              <ui-view class="wrap">
                <ui-view class="accessory_wrap">
                  <ui-text block>附件</ui-text>
                  <ui-view class="accessory_content">
                    <ui-view class="accessory_list"
                    ui:for="{{ item2.imgs }}"
                    ui:for-item="item3"
                    >
                      <ui-view class="close">x</ui-view>
                      <ui-image
                      src="{{ item3 }}"
                      mode='aspectFill'
                      width="60"
                      height="60"
                      ></ui-image>
                    </ui-view>
                    <ui-view class="add_accessory" bindtap="addAccessory(index1,index2)">
                      <ui-view>
                        <ui-icon name="plus2" size="20" color="#B3B5B5"></ui-icon>
                      </ui-view>
                    </ui-view>
                  </ui-view>
                </ui-view>
              </ui-view>
            </ui-view>
            <!-- 每一个报销单的总额 -->
            <ui-view class="recipients">
              <!-- <ui-view class="title">报销总额</ui-view> -->
              <ui-row height="50">
                <ui-col vertical-align="middle" align="left" width="70" space-left="10">
                  <ui-view>人民币</ui-view>
                </ui-col>
                <ui-col vertical-align="middle" align="right" space="20">
                  <ui-view class="right_column">2000</ui-view>
                </ui-col>
              </ui-row>
            </ui-view>
            <ui-row class="add_detail">
              <ui-col vertical-align="middle" align="right" space-right="10" bindtap="addExpense(index1)">
                <ui-view>
                  <ui-icon name="plus2" size="18" color="#3286F4"></ui-icon>增加报销明细
                </ui-view>
              </ui-col>
              <ui-col vertical-align="middle" align="left" space-left="10" bindtap="chooseExpense(index1)">
                <ui-view>
                  <ui-icon name="plus2" size="18" color="#3286F4"></ui-icon>导入报销明细
                </ui-view>
              </ui-col>
            </ui-row>
            
          </ui-view>
        </ui-view>
        <ui-view class="add_bill">
          <ui-view bindtap="addExpenseList">添加报销单</ui-view>
        </ui-view>
      </ui-view>



      <!-- END-->
      <!-- <ui-row >
        <ui-col vertical-align="middle" align="right" width="70">
          <ui-view>备注</ui-view>
        </ui-col>
        <ui-col vertical-align="middle" align="left" space="20">
          <ui-textarea height="80" placeholder="请输入备注内容" maxlength="-1" placeholder-class="blue-placeholder"></ui-textarea>
        </ui-col>
      </ui-row> -->
      <ui-view class="detail_description">
        <ui-text block>备注</ui-text>
        <ui-textarea maxlength="-1" placeholder="请输入备注内容" placeholder-style="color:#999B9E" ui:model="{{ memo }}"></ui-textarea>
      </ui-view>


      <!-- 审批人 -->
      <ui-view class="recipients">
        <ui-view class="title">审批人</ui-view>
        <ui-view class="recipients_content">
          <ui-view class="recipients_list" ui:for="{{ approverList }}" ui:for-item="item">
            <ui-view class="list_content" bindtap="deleteApprovers(index)">
              <ui-view class="close">x</ui-view>
              <ui-image
              src="{{ item.img }}"
              ></ui-image>
              <ui-text>{{ item.name }}</ui-text>
            </ui-view>
          </ui-view>
          <ui-view class="recipients_list" bindtap="addApprovers">
            <ui-view class="add_recipients">
              <ui-icon name="plus2" size="20" color="#B3B5B5"></ui-icon>
            </ui-view>
          </ui-view>
        </ui-view>
      </ui-view>


     <!-- 抄送人 -->
      <ui-view class="recipients">
        <ui-view class="title">抄送人</ui-view>
        <ui-view class="recipients_content">
          <ui-view class="recipients_list" ui:for="{{ recipientsList }}" ui:for-item="item">
            <ui-view class="list_content" bindtap="deleteRecipients(index)">
              <ui-view class="close">x</ui-view>
              <ui-image
              src="{{ item.head }}"
              ></ui-image>
              <ui-text>{{ item.userName }}</ui-text>
            </ui-view>
          </ui-view>
          <ui-view class="recipients_list" bindtap="addRecipients">
            <ui-view class="add_recipients">
              <ui-icon name="plus2" size="20" color="#B3B5B5"></ui-icon>
            </ui-view>
          </ui-view>
        </ui-view>
      </ui-view>

      <ui-view class="recipients">
        <ui-view class="title">报销总额</ui-view>
        <ui-row height="50">
          <ui-col vertical-align="middle" align="left" width="70" space-left="10">
            <ui-view>人民币</ui-view>
          </ui-col>
          <ui-col vertical-align="middle" align="right" space="20">
            <ui-view class="right_column">2000</ui-view>
          </ui-col>
        </ui-row>
      </ui-view>






      <ui-row height="50" space-top="10">
        <ui-col vertical-align="middle" align="right" space="20">
          <ui-button type="default" size="small" plain="true">保存为草稿</ui-button>
        </ui-col>
        <ui-col vertical-align="middle" align="left" space="20">
          <ui-button type="primary" size="small">立即提交</ui-button>
        </ui-col>
      </ui-row>
    </ui-view>
    








    <!-- 报销日期 -->
    <ui-popup ui:model="{{ radioCalendar }}">
      <ui-view>
        <ui-row height="{{headerHeight}}">
          <ui-col align="left" vertical-align="middle" width="70" space-left="10" bindtap="handleSelect('radioCalendar')">
              <!-- <ui-icon name="close" color="#e60012"></ui-icon> -->
          </ui-col>
          <ui-col align="center" vertical-align="middle">
            <ui-text>选择日期</ui-text>
          </ui-col>
          <ui-col align="center" vertical-align="middle" width="70">
          </ui-col>
        </ui-row>
        <ui-calendar
        type="vertical"
        select-range-mode="{{false}}"
        header-height="30"
        height="319"
        show-today
        show-month-range="{{monthrange}}"
        bindchange="selectedChange($event)"
        value="{{radioDate}}"
        can-select-today="true"
      ></ui-calendar>
      </ui-view>
    </ui-popup>

   

    <!-- 出差时间 -->
    <ui-popup ui:model="{{ rangeCalendar }}">
      <ui-view>
        <ui-row space-top="{{statusBarHeight}}" height="{{headerHeight}}" > 
          <ui-col></ui-col>
          <ui-col align="right" space-right="10" width="70" vertical-align="middle" bindtap="handleSelect('rangeCalendar')">
            <ui-text>完成</ui-text>
          </ui-col>
        </ui-row>
        <ui-calendar
        type="vertical"
        height="{{height - headerHeight}}"
        select-range-mode="{{true}}"
        show-month-range="{{monthrange}}"
        max-range="{{30}}"
        bindselectedstart="selectedStartHandler($event)"
        bindselectedend="selectedEndHandler($event)"
        bindfailed="failedHandler($event)"
        start-range-color="#125cbc"
        end-range-color="#125cbc"
        range-color="#125cbc"
        can-select-today="true"
      ></ui-calendar>
      </ui-view>
    </ui-popup>

  </ui-page>
</template>
